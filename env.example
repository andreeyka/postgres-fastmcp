# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
# Host to bind the server to (use 0.0.0.0 for containers/Kubernetes, 127.0.0.1 for local development)
MCP_SERVER_HOST=0.0.0.0

# Port to bind the server to
MCP_SERVER_PORT=8000

# Global transport type: 'http' or 'stdio'
MCP_SERVER_TRANSPORT=http

# Default endpoint path
MCP_SERVER_ENDPOINT=mcp

# Number of workers to run
MCP_SERVER_WORKERS=1

# Suppress deprecation warnings
MCP_SERVER_DEPRECATION_WARNINGS=true

# Enable health check endpoint at /health (no authorization required)
MCP_SERVER_HEALTH_ENDPOINT_ENABLED=true


# =============================================================================
# FASTMCP CONFIGURATION
# =============================================================================
# MCP server name
MCP_FASTMCP_SERVER_NAME=postgres-fastmcp

# Mask internal error details for security
MCP_FASTMCP_MASK_ERROR_DETAILS=true

# Return errors as strings in LLM responses instead of standard MCP errors
MCP_FASTMCP_RETURN_ERRORS_AS_STRINGS=true

# Include traceback in error strings when return_errors_as_strings=true
MCP_FASTMCP_ERROR_TRACEBACK_IN_STRINGS=false


# =============================================================================
# ERROR HANDLING MIDDLEWARE
# =============================================================================
# Enable ErrorHandlingMiddleware
MCP_ERROR_HANDLING_ENABLED=true

# Include full traceback in error logs
MCP_ERROR_HANDLING_TRACEBACK=false

# Transform non-MCP errors to MCP errors
MCP_ERROR_HANDLING_TRANSFORM=true


# =============================================================================
# RETRY MIDDLEWARE
# =============================================================================
# Enable RetryMiddleware
MCP_RETRY_ENABLED=true

# Maximum number of retries
MCP_RETRY_MAX_RETRIES=3

# Base delay between retries in seconds
MCP_RETRY_BASE_DELAY=1.0

# Maximum delay between retries in seconds
MCP_RETRY_MAX_DELAY=60.0

# Exponential backoff multiplier
MCP_RETRY_BACKOFF_MULTIPLIER=2.0


# =============================================================================
# CACHING MIDDLEWARE
# =============================================================================
# Enable ResponseCachingMiddleware
MCP_CACHING_ENABLED=true

# Use Redis for cache instead of memory (requires MCP_REDIS_* variables)
MCP_CACHING_USE_REDIS=false

# Maximum cache item size in bytes
MCP_CACHING_MAX_ITEM_SIZE=1048576

# TTL for tools/call in seconds
MCP_CACHING_CALL_TOOL_TTL=300

# TTL for resources/read in seconds
MCP_CACHING_READ_RESOURCE_TTL=300

# TTL for prompts/get in seconds
MCP_CACHING_GET_PROMPT_TTL=300

# List of tools excluded from caching (comma-separated)
MCP_CACHING_EXCLUDED_TOOLS=


# =============================================================================
# LOGGING MIDDLEWARE
# =============================================================================
# Enable StructuredLoggingMiddleware
MCP_LOGGING_ENABLED=false

# Log level
MCP_LOGGING_LEVEL=INFO

# Include payloads in logs
MCP_LOGGING_INCLUDE_PAYLOADS=false

# Include payload length in logs
MCP_LOGGING_INCLUDE_PAYLOAD_LENGTH=true

# Estimate token count in payload
MCP_LOGGING_ESTIMATE_TOKENS=false


# =============================================================================
# TIMING MIDDLEWARE
# =============================================================================
# Enable TimingMiddleware for request timing
MCP_TIMING_ENABLED=false

# Log level for timing middleware
MCP_TIMING_LOG_LEVEL=INFO


# =============================================================================
# DETAILED TIMING MIDDLEWARE
# =============================================================================
# Enable DetailedTimingMiddleware for detailed operation timing
MCP_DETAILED_TIMING_ENABLED=false

# Log level for detailed timing middleware
MCP_DETAILED_TIMING_LOG_LEVEL=INFO


# =============================================================================
# KEYCLOAK AUTHENTICATION
# =============================================================================
# Enable Keycloak authentication
MCP_KEYCLOAK_ENABLED=false

# Keycloak server URL (without /realms/...)
MCP_KEYCLOAK_SERVER_URL=https://keycloak.example.com

# Keycloak realm name
MCP_KEYCLOAK_REALM=demo

# OAuth2 client_id
MCP_KEYCLOAK_CLIENT_ID=postgres-fastmcp

# Keycloak audience (optional, uses client_id if not set)
# MCP_KEYCLOAK_AUDIENCE=

# Required OAuth scopes (comma-separated, optional)
# MCP_KEYCLOAK_REQUIRED_SCOPES=


# =============================================================================
# REDIS CONFIGURATION (for caching)
# =============================================================================
# Redis host
MCP_REDIS_HOST=localhost

# Redis port
MCP_REDIS_PORT=6379

# Redis database number
MCP_REDIS_DB=0

# Redis password (optional, if not set, connection without password)
# MCP_REDIS_PASSWORD=

# Decode Redis responses as strings
MCP_REDIS_DECODE_RESPONSES=true


# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================
# Docker image repository (full path without tag)
# Example: repo.mng.sbercloud.tech/cpe_automation/postgres-fastmcp
DOCKER_IMAGE=postgres-fastmcp

# Docker image tag
DOCKER_TAG=latest


# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# Use nested delimiter __ (double underscore) for nested configuration
#
# Example for single database:
# MCP_DATABASES__PRODUCTION__DATABASE_URI=postgresql://user:password@localhost:5432/production
# MCP_DATABASES__PRODUCTION__ROLE=full
# MCP_DATABASES__PRODUCTION__ACCESS_MODE=restricted
# MCP_DATABASES__PRODUCTION__ENDPOINT=false
# MCP_DATABASES__PRODUCTION__TRANSPORT=http
#
# Example for multiple databases:
# MCP_DATABASES__PRODUCTION__DATABASE_URI=postgresql://user:password@localhost:5432/production
# MCP_DATABASES__PRODUCTION__ROLE=full
# MCP_DATABASES__PRODUCTION__ACCESS_MODE=restricted
# MCP_DATABASES__PRODUCTION__ENDPOINT=false
# MCP_DATABASES__DEVELOPMENT__DATABASE_URI=postgresql://user:password@localhost:5432/development
# MCP_DATABASES__DEVELOPMENT__ROLE=user
# MCP_DATABASES__DEVELOPMENT__ACCESS_MODE=unrestricted
# MCP_DATABASES__DEVELOPMENT__ENDPOINT=true
